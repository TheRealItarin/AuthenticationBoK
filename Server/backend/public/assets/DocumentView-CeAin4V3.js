import{_ as d,p as m,g as _,c as n,b as e,h as c,i as p,v as f,e as v,j as g,t as a,F as w,k as x,o as r,n as b,f as k,r as E}from"./index-CPnzo6a5.js";const D={name:"DocumentsComponent",data(){return{token:localStorage.getItem("token"),entries:[],newText:"",role:null,canRead:!1,canEdit:!1,loading:!0,error:null}},mounted(){this.fetchEntries(),setInterval(()=>this.fetchEntries(),5e3)},methods:{async fetchEntries(){try{const s=await _("/text-content");this.entries=s.entries,this.role=s.role,this.canRead=!0,this.canEdit=s.can_edit,this.error=null}catch(s){console.error("Fetch error details:",s.details),console.error("Status code:",s.status),s.status===403?(this.canRead=!1,this.error="You don't have the necessary role to access this content"):s.status===401&&(this.error="Please log in again")}finally{this.loading=!1}},async addEntry(){if(!this.newText.trim()){this.error="Please enter some text before submitting";return}try{const s=await m("/text-content",{text:this.newText});this.entries.unshift(s.entry),this.newText="",this.error=null}catch(s){console.error("Add entry error:",s),s.status===403?(this.error="Your role has changed. Please log in again.",this.fetchEntries()):this.error="Failed to add entry. Please try again."}},formatDate(s){return new Date(s).toLocaleString()}}},T={class:"documents-container"},C={key:0,class:"alert alert-danger"},S={key:1,class:"alert alert-warning"},A={key:2,class:"content-area"},N={key:0,class:"alert alert-info"},P={key:1,class:"writer-section"},Y={class:"form-group"},V={class:"entries-section"},B={class:"entries-header"},R={key:0,class:"entry-count"},F={key:0,class:"entries-list"},I={class:"entry-header"},U={class:"entry-author-info"},L={class:"author-avatar"},M={class:"author-details"},W={class:"author-name"},j={class:"entry-date"},q={class:"entry-body"},z={class:"entry-footer"},O={class:"entry-id"},G={key:1,class:"alert alert-secondary"},H={key:0},J={key:1},K={key:2,class:"alert alert-danger mt-3"};function Q(s,t,u,h,o,l){return r(),n("div",T,[t[11]||(t[11]=e("div",{class:"documents-header"},[e("h2",null,"üìÑ Secure Document Library"),e("p",{class:"header-subtitle"},"Manage and view secure text entries")],-1)),o.token?o.canRead?(r(),n("div",A,[o.canEdit?(r(),n("div",P,[t[7]||(t[7]=e("div",{class:"writer-header"},[e("h3",null,"‚úçÔ∏è Add New Entry"),e("p",null,"Share your content with the team (Writer privilege)")],-1)),e("form",{onSubmit:t[1]||(t[1]=g((...i)=>l.addEntry&&l.addEntry(...i),["prevent"])),class:"writer-form"},[e("div",Y,[t[5]||(t[5]=e("label",{for:"text-entry"},"Your Text Entry:",-1)),p(e("textarea",{id:"text-entry","onUpdate:modelValue":t[0]||(t[0]=i=>o.newText=i),placeholder:"Write your text here... This will be saved securely and attributed to your account.",class:"form-control textarea-large"},null,512),[[f,o.newText]])]),t[6]||(t[6]=e("button",{type:"submit",class:"btn btn-primary"},[e("span",null,"‚ûï"),v(" Add Entry ")],-1))],32)])):(r(),n("div",N,[...t[4]||(t[4]=[e("strong",null,"‚ÑπÔ∏è Read-Only Access",-1),e("p",null,"You have read-only access to documents. Upgrade your role to writer to contribute new entries.",-1)])])),e("div",V,[e("div",B,[t[8]||(t[8]=e("h3",null,"üìö Document Entries",-1)),o.entries.length>0?(r(),n("span",R,a(o.entries.length)+" entries",1)):c("",!0)]),o.entries.length>0?(r(),n("div",F,[(r(!0),n(w,null,x(o.entries,(i,y)=>(r(),n("div",{key:i.id,class:"entry-card",style:b({animationDelay:`${y*.05}s`})},[e("div",I,[e("div",U,[e("div",L,a(i.written_by.charAt(0).toUpperCase()),1),e("div",M,[e("strong",W,a(i.written_by),1),e("time",j,a(l.formatDate(i.created_at)),1)])])]),e("div",q,a(i.text),1),e("div",z,[e("span",O,"Entry #"+a(i.id),1)])],4))),128))])):(r(),n("div",G,[t[9]||(t[9]=e("strong",null,"üì≠ No Entries Yet",-1)),o.canEdit?(r(),n("p",H,'Be the first to contribute! Use the "Add New Entry" section above to get started.')):(r(),n("p",J,"No entries available yet. Check back later for shared documents."))]))]),o.error?(r(),n("div",K,[t[10]||(t[10]=e("strong",null,"‚ùå Error",-1)),e("p",null,a(o.error),1)])):c("",!0)])):(r(),n("div",S,[...t[3]||(t[3]=[e("strong",null,"‚ö†Ô∏è Insufficient Permissions",-1),e("p",null,"Your current role does not have the necessary permissions to access document content. Please contact an administrator.",-1)])])):(r(),n("div",C,[...t[2]||(t[2]=[e("strong",null,"üîí Access Denied",-1),e("p",null,"Please log in first to access the document library. Your credentials are required for security verification.",-1)])]))])}const X=d(D,[["render",Q],["__scopeId","data-v-992d7a58"]]),Z={name:"DocumentView",components:{DocumentsComponent:X}};function $(s,t,u,h,o,l){const i=E("DocumentsComponent");return r(),k(i)}const te=d(Z,[["render",$]]);export{te as default};
